var Persona=function(){function d(a){return function(){4==a.readyState&&(response=eval("("+a.response+")"),"success"==response.status?"undefined"!==typeof response.redirect?window.location=response.redirect:window.location.reload():"failure"==response.status?navigator.id.logout():alert("XMLHttpRequest error: "+a.status))}}var c={init:function(a,b,d){c.currentUser=""===d?null:d;c.loginUrl=a;c.logoutUrl=b;navigator.id.watch({loggedInUser:c.currentUser,onlogin:c.verifyAssertion,onlogout:c.signoutUser})},
verifyAssertion:function(a){var b=new XMLHttpRequest;b.open("POST",c.loginUrl,!0);a="assert="+a;b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.setRequestHeader("Content-length",a.length);b.setRequestHeader("Connection","close");b.send(a);b.onreadystatechange=d(b)},signoutUser:function(){var a=new XMLHttpRequest;a.open("GET",c.logoutUrl,!0);a.send(null);a.onreadystatechange=d(a)}};return c}();
